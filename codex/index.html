<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Codex Entries</title>
  <style>
    body {
      background: #0b0e13;
      color: #e8e8e8;
      font-family: Georgia, serif;
      text-align: center;
      padding: 40px;
    }

    h1 {
      font-size: 38px;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .sub {
      color: #aaa;
      font-style: italic;
      margin-bottom: 30px;
    }

    input {
      padding: 6px 10px;
      width: 240px;
      border-radius: 4px;
      border: 1px solid #444;
      background: #111;
      color: #eee;
      margin-bottom: 20px;
    }

    a.item {
      display: block;
      margin: 10px auto;
      padding: 8px 0;
      width: 320px;
      text-decoration: none;
      background: #131820;
      border-radius: 6px;
      border: 1px solid #2a3242;
      transition: 0.2s;
      color: #9dc3ff;
    }

    a.item:hover {
      background: #1b2230;
      border-color: #4a78c7;
      color: #ffffff;
    }

    .count {
      margin-top: 10px;
      color: #b5b5b5;
    }

    .back {
      display: inline-block;
      margin-bottom: 20px;
      color: #7da7ff;
      text-decoration: none;
    }
  </style>
</head>

<body>

  <h1>Codex Entries</h1>
  <div class="sub">Each entry is a moment of awareness recorded in time.</div>

  <a class="back" href="../index.html">‚Üê Return to Origin</a>

  <br>
  <input id="search" type="text" placeholder="Search entries...">

  <div class="count" id="count"></div>

  <div id="list"></div>

  <script>
    // Auto-detect .md files that GitHub Pages exposes through directory listing JSON
    fetch("./")
      .then(r => r.text())
      .then(html => {
        // Extract .md filenames from HTML listing (works in GitHub pages environment)
        const regex = /href="([^"]+\.md)"/g;
        let match, files = [];
        while (match = regex.exec(html)) files.push(match[1]);

        window.mdFiles = files.sort();
        render();
      });

    function render(filter = "") {
      filter = filter.toLowerCase();
      const list = document.getElementById("list");
      const display = window.mdFiles
        .filter(name => name.toLowerCase().includes(filter))
        .map((name, index) => {
          const clean = name.replace(".md", "").replace(/-/g, " ");
          return `<a class="item" href="../view-pretty.html?f=codex/${encodeURIComponent(name)}">
                    ${index + 1}. ${clean}
                  </a>`;
        })
        .join("");

      list.innerHTML = display;
      document.getElementById("count").textContent =
        `${window.mdFiles.length} entries`;
    }

    document.getElementById("search").addEventListener("input", (e) => {
      render(e.target.value);
    });
  </script>

  <br><br>
  <div class="sub">Awareness is here before the story.</div>

</body>
</html>
